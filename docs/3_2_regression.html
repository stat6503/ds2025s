<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>regression – R&amp;E 활동</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-2f6844b3748638c5738d4cf93630e566.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">R&amp;E 활동</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./notice.html"> 
<span class="menu-text">[과제 공지]</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-python-basic" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Python Basic</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-python-basic">    
        <li>
    <a class="dropdown-item" href="./1_1_environment.html">
 <span class="dropdown-text">(1) Python 개발 환경</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./1_2_basic.html">
 <span class="dropdown-text">(2) 기초 문법</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-data-exploration" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Data Exploration</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-data-exploration">    
        <li>
    <a class="dropdown-item" href="./2_1_numpy.html">
 <span class="dropdown-text">(1) NumPy</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./2_2_pandas.html">
 <span class="dropdown-text">(2) Pandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./2_3_matplotlib.html">
 <span class="dropdown-text">(3) Matplotlib</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./2_4_seaborn.html">
 <span class="dropdown-text">(4) Seaborn</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-machine-learning" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Machine Learning</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-machine-learning">    
        <li>
    <a class="dropdown-item" href="./3_1_machine_learning.html">
 <span class="dropdown-text">(1) 머신러닝</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./3_2_regression.html">
 <span class="dropdown-text">(2) 지도학습：회귀</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./3_3_classification.html">
 <span class="dropdown-text">(3) 지도학습：분류</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
  <li><a href="#상관분석" id="toc-상관분석" class="nav-link active" data-scroll-target="#상관분석">8.1. 상관분석</a></li>
  <li><a href="#단순선형-회귀분석" id="toc-단순선형-회귀분석" class="nav-link" data-scroll-target="#단순선형-회귀분석">8.2. 단순선형 회귀분석</a></li>
  <li><a href="#실습-날씨-데이터-분석" id="toc-실습-날씨-데이터-분석" class="nav-link" data-scroll-target="#실습-날씨-데이터-분석">8.3. (실습) 날씨 데이터 분석</a></li>
  <li><a href="#다중선형-회귀분석" id="toc-다중선형-회귀분석" class="nav-link" data-scroll-target="#다중선형-회귀분석">8.4. 다중선형 회귀분석</a></li>
  <li><a href="#실습-캘리포니아-주택-가격-분석" id="toc-실습-캘리포니아-주택-가격-분석" class="nav-link" data-scroll-target="#실습-캘리포니아-주택-가격-분석">8.5. (실습) 캘리포니아 주택 가격 분석</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>




<h1>
<ol start="8" type="1">
<li>지도학습 : 회귀
</li></ol></h1>

<section id="상관분석" class="level2">
<h2 class="anchored" data-anchor-id="상관분석">8.1. 상관분석</h2>
<section id="상관계수" class="level3">
<h3 class="anchored" data-anchor-id="상관계수">8.1.1. 상관계수</h3>
<ul>
<li>상관분석(correlation analysis)
<ul>
<li>두 수치형 변수 간 선형적인 관계(linear relationship)를 파악하는 통계 기법</li>
<li>상관계수(correlation coefficient)
<ul>
<li>두 변수 간 상관관계를 수치로 나타내어 정량화한 지표</li>
<li>상관계수의 절대값은 선형성의 강도를, 부호는 선형성의 방향성을 나타냄</li>
<li>변수의 측정 단위의 영향을 받지 않음</li>
</ul></li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li>상관계수의 성질
<ul>
<li>상관계수 r은 항상 -1에서 +1 사이의 값을 가짐</li>
<li>절대값이 1에 가까울수록 강한 상관관계를 의미함</li>
<li>r&gt;0이면 양의 상관관계, r&lt;0이면 음의 상관관계, r=0이면 상관관계가 없음을 나타냄
<ul>
<li>양의 상관관계 : 한 변수가 증가할 때 다른 변수도 증가</li>
<li>음의 상관관계 : 한 변수가 증가할 때 다른 변수는 감소</li>
<li>상관관계 없음 : 한 변수가 증가할 때 다른 변수는 영향을 받지 않음</li>
</ul></li>
</ul></li>
</ul>
<p><br></p>
<p><img src="./images/fig3-7.jpg" class="img-fluid" style="width:70.0%"></p>
<p><br></p>
</section>
<section id="실습-행복지수-데이터-분석" class="level3">
<h3 class="anchored" data-anchor-id="실습-행복지수-데이터-분석">8.1.2. (실습) 행복지수 데이터 분석</h3>
<ul>
<li>[데이터] 캐글에서 제공하는 전세계 행복지수 데이터
<ul>
<li>1인당 GDP, 사회적 지지 정도, 건강한 기대수명, 인생 선택의 자유, 기부</li>
<li>[실습파일] <a href="./data/2020.csv">2020.csv</a>, <a href="./data/2021.csv">2021.csv</a></li>
</ul></li>
</ul>
<p><br></p>
<blockquote class="blockquote">
<p><strong>행복지수와 관련된 요인은 무엇일까?</strong></p>
</blockquote>
<p><br></p>
<div id="a6cedb24" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">## (1) 데이터 확인 및 전처리</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="bcb07071" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 라이브러리 불러오기</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="e10a120e" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 불러오기</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>df2020 <span class="op">=</span> pd.read_csv(<span class="st">'./data/2020.csv'</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>df2021 <span class="op">=</span> pd.read_csv(<span class="st">'./data/2021.csv'</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="d6013551" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 열 정보</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df2020.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>Country name                     object
Happiness score                 float64
upperwhisker                    float64
lowerwhisker                    float64
GDP per capita                  float64
Social support                  float64
Healthy life expectancy         float64
Freedom to make life choices    float64
Generosity                      float64
Dystopia                        float64
dtype: object</code></pre>
</div>
</div>
<div id="23c5de93" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2020년 데이터 확인</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>df2020.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Country name</th>
<th data-quarto-table-cell-role="th">Happiness score</th>
<th data-quarto-table-cell-role="th">upperwhisker</th>
<th data-quarto-table-cell-role="th">lowerwhisker</th>
<th data-quarto-table-cell-role="th">GDP per capita</th>
<th data-quarto-table-cell-role="th">Social support</th>
<th data-quarto-table-cell-role="th">Healthy life expectancy</th>
<th data-quarto-table-cell-role="th">Freedom to make life choices</th>
<th data-quarto-table-cell-role="th">Generosity</th>
<th data-quarto-table-cell-role="th">Dystopia</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Rank</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>Finland</td>
<td>7.8087</td>
<td>7.869766</td>
<td>7.747634</td>
<td>10.639267</td>
<td>0.954330</td>
<td>71.900825</td>
<td>0.949172</td>
<td>-0.059482</td>
<td>2.762835</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>Denmark</td>
<td>7.6456</td>
<td>7.711245</td>
<td>7.579955</td>
<td>10.774001</td>
<td>0.955991</td>
<td>72.402504</td>
<td>0.951444</td>
<td>0.066202</td>
<td>2.432741</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>Switzerland</td>
<td>7.5599</td>
<td>7.628528</td>
<td>7.491272</td>
<td>10.979933</td>
<td>0.942847</td>
<td>74.102448</td>
<td>0.921337</td>
<td>0.105911</td>
<td>2.350267</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>Iceland</td>
<td>7.5045</td>
<td>7.621347</td>
<td>7.387653</td>
<td>10.772559</td>
<td>0.974670</td>
<td>73.000000</td>
<td>0.948892</td>
<td>0.246944</td>
<td>2.460688</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>Norway</td>
<td>7.4880</td>
<td>7.556281</td>
<td>7.419719</td>
<td>11.087804</td>
<td>0.952487</td>
<td>73.200783</td>
<td>0.955750</td>
<td>0.134533</td>
<td>2.168266</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="5bfac4cd" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2021년 데이터 확인</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>df2021.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Country name</th>
<th data-quarto-table-cell-role="th">Happiness score</th>
<th data-quarto-table-cell-role="th">upperwhisker</th>
<th data-quarto-table-cell-role="th">lowerwhisker</th>
<th data-quarto-table-cell-role="th">GDP per capita</th>
<th data-quarto-table-cell-role="th">Social support</th>
<th data-quarto-table-cell-role="th">Healthy life expectancy</th>
<th data-quarto-table-cell-role="th">Freedom to make life choices</th>
<th data-quarto-table-cell-role="th">Generosity</th>
<th data-quarto-table-cell-role="th">Dystopia</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Rank</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>Finland</td>
<td>7.842</td>
<td>7.904</td>
<td>7.780</td>
<td>10.775</td>
<td>0.954</td>
<td>72.0</td>
<td>0.949</td>
<td>-0.098</td>
<td>3.253</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>Denmark</td>
<td>7.620</td>
<td>7.687</td>
<td>7.552</td>
<td>10.933</td>
<td>0.954</td>
<td>72.7</td>
<td>0.946</td>
<td>0.030</td>
<td>2.868</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>Switzerland</td>
<td>7.571</td>
<td>7.643</td>
<td>7.500</td>
<td>11.117</td>
<td>0.942</td>
<td>74.4</td>
<td>0.919</td>
<td>0.025</td>
<td>2.839</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>Iceland</td>
<td>7.554</td>
<td>7.670</td>
<td>7.438</td>
<td>10.878</td>
<td>0.983</td>
<td>73.0</td>
<td>0.955</td>
<td>0.160</td>
<td>2.967</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>Netherlands</td>
<td>7.464</td>
<td>7.518</td>
<td>7.410</td>
<td>10.932</td>
<td>0.942</td>
<td>72.4</td>
<td>0.913</td>
<td>0.175</td>
<td>2.798</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="0d392411" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 전처리 : 열 삭제</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>df2020.drop([<span class="st">'upperwhisker'</span>, <span class="st">'lowerwhisker'</span>, <span class="st">'Dystopia'</span>], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>df2021.drop([<span class="st">'upperwhisker'</span>, <span class="st">'lowerwhisker'</span>, <span class="st">'Dystopia'</span>], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="b1753f96" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 열 이름 변경 : 공백을 _으로 대체</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#df2020.columns = df2020.columns.str.replace(' ','._')</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#df2021.columns = df2021.columns.str.replace(' ','_')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="1a82dbe1" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 전처리 : 열 이름 변경</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df2020.columns <span class="op">=</span> [<span class="st">'Country'</span>, <span class="st">'Score'</span>, <span class="st">'GDP_per_capita'</span>, <span class="st">'Social_support'</span>, <span class="st">'Life_expectancy'</span>, <span class="st">'Freedom'</span>, <span class="st">'Generosity'</span>]</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>df2021.columns <span class="op">=</span> [<span class="st">'Country'</span>, <span class="st">'Score'</span>, <span class="st">'GDP_per_capita'</span>, <span class="st">'Social_support'</span>, <span class="st">'Life_expectancy'</span>, <span class="st">'Freedom'</span>, <span class="st">'Generosity'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<div id="e48f9d6a" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">## (2) 데이터 분석 및 시각화</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">## (2-1) 행복 점수와 기능의 상관관계</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">##       한 국가의 행복지수와 경제적(GDP), 법적 상태(Freedom)는 상관관계가 있는가?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="8521fe63" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2020년 데이터 전처리</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> df2020.copy()</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>df1.drop([<span class="st">'Social_support'</span>, <span class="st">'Life_expectancy'</span>, <span class="st">'Generosity'</span>], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>df1.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Country</th>
<th data-quarto-table-cell-role="th">Score</th>
<th data-quarto-table-cell-role="th">GDP_per_capita</th>
<th data-quarto-table-cell-role="th">Freedom</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Rank</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>Finland</td>
<td>7.8087</td>
<td>10.639267</td>
<td>0.949172</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>Denmark</td>
<td>7.6456</td>
<td>10.774001</td>
<td>0.951444</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>Switzerland</td>
<td>7.5599</td>
<td>10.979933</td>
<td>0.921337</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>Iceland</td>
<td>7.5045</td>
<td>10.772559</td>
<td>0.948892</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>Norway</td>
<td>7.4880</td>
<td>11.087804</td>
<td>0.955750</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="1bd0db16" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 산점도 : 2020년 데이터</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>sns.pairplot(df1, height<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="3_2_regression_files/figure-html/cell-13-output-1.png" width="569" height="568" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="6a472c9b" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 상관계수 : 2020년 데이터</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 행복지수와 GDP 간 상관계수는 0.78로, 강한 양의 상관관계임</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 행복지수와 Freedom 간 상관계수는 0.59로, 뚜렷한 양의 상관관계임</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>corr <span class="op">=</span> df1.select_dtypes(include<span class="op">=</span><span class="st">'number'</span>).corr()</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>corr[<span class="st">'Score'</span>].sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>Score             1.000000
GDP_per_capita    0.775374
Freedom           0.590597
Name: Score, dtype: float64</code></pre>
</div>
</div>
<div id="252ac45b" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 상관분석 : 2020년 데이터</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">4</span>))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>sns.heatmap(corr, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">'Blues'</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="3_2_regression_files/figure-html/cell-15-output-1.png" width="466" height="342" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="f602fe8c" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2021년 데이터 전처리</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> df2021.copy()</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>df2.drop([<span class="st">'Social_support'</span>, <span class="st">'Life_expectancy'</span>, <span class="st">'Generosity'</span>], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>df2.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Country</th>
<th data-quarto-table-cell-role="th">Score</th>
<th data-quarto-table-cell-role="th">GDP_per_capita</th>
<th data-quarto-table-cell-role="th">Freedom</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Rank</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>Finland</td>
<td>7.842</td>
<td>10.775</td>
<td>0.949</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>Denmark</td>
<td>7.620</td>
<td>10.933</td>
<td>0.946</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>Switzerland</td>
<td>7.571</td>
<td>11.117</td>
<td>0.919</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>Iceland</td>
<td>7.554</td>
<td>10.878</td>
<td>0.955</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>Netherlands</td>
<td>7.464</td>
<td>10.932</td>
<td>0.913</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="c15c4bc9" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 산점도 : 2021년 데이터</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>sns.pairplot(df2, height<span class="op">=</span><span class="dv">2</span>, diag_kind<span class="op">=</span><span class="st">'kde'</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="3_2_regression_files/figure-html/cell-17-output-1.png" width="569" height="568" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="d0e78886" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 상관분석 : 2021년 데이터</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 행복지수와 GDP 간 상관계수는 0.79로, 강한 양의 상관관계임</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 헹복지수와 Freedom 간 상관계수는 0.61로, 뚜렷한 양의 상관관계임</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">4</span>))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>sns.heatmap(df2.select_dtypes(include<span class="op">=</span><span class="st">'number'</span>).corr(), annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">'PuBuGn'</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="3_2_regression_files/figure-html/cell-18-output-1.png" width="466" height="342" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
<section id="결과-및-시사점" class="level5">
<h5 class="anchored" data-anchor-id="결과-및-시사점"><strong>결과 및 시사점</strong></h5>
<ul>
<li>행복지수와 GDP 간 관계는?
<ul>
<li>상관계수는 2020년 0.78, 2021년 0.79로, 강한 양의 상관관계로 나타남</li>
<li>경제 성장은 일반적으로 더 높은 소득과 향상된 생활 수준으로 이어지므로, 국민의 행복 수준도 높아지는 경향이 있음</li>
<li>따라서 국민의 행복을 보장하기 위해, 국가의 GDP를 주요 우선순위로 고려할 필요가 있음</li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li>행복지수와 인생 선택의 자유 간 관계는?
<ul>
<li>상관계수는 2020년 0.59, 2021년 0.61로, 뚜렷한 양의 상관관계로 나타남</li>
<li>자유에 대한 인식은 지역과 문화에 따라 다양하기 때문에 일반화하기는 어려움</li>
<li>그럼에도 불구하고, 개인이 삶을 선택할 자유를 얼마나 느끼는지는 국민의 행복 수준에 중요한 영향을 미침</li>
</ul></li>
</ul>
<p><br></p>
<div id="85f4a98b" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">## (2-2) 행복 점수와 사회적 상태의 상관관계</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">##       한 국가의 행복지수와 사회적 상태(Social.support)는 상관관계가 있는가?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="e9c639ab" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 전처리</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>x1 <span class="op">=</span> df2020[[<span class="st">'Generosity'</span>, <span class="st">'Social_support'</span>, <span class="st">'Score'</span>]].copy()</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>x2 <span class="op">=</span> df2021[[<span class="st">'Generosity'</span>, <span class="st">'Social_support'</span>, <span class="st">'Score'</span>]].copy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="6a677a30" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 상관분석 : 2020년 데이터</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>a1 <span class="op">=</span> x1.corr()</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">4</span>))</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>sns.heatmap(a1, annot<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="3_2_regression_files/figure-html/cell-21-output-1.png" width="466" height="342" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="f986d31d" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 상관분석 : 2021년 데이터</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>a2 <span class="op">=</span> x2.corr()</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">4</span>))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>sns.heatmap(a2, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">'GnBu'</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="3_2_regression_files/figure-html/cell-22-output-1.png" width="466" height="342" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="결과-및-시사점-1" class="level5">
<h5 class="anchored" data-anchor-id="결과-및-시사점-1"><strong>결과 및 시사점</strong></h5>
<ul>
<li>행복지수와 사회적 지지 간 관계는?
<ul>
<li>상관계수는 2020년 0.77, 2021년 0.76으로, 강한 양의 상관관계로 나타남</li>
<li>사회적 지지는 가족, 친구, 지인 등과 함께 있으면서 느끼는 정서적 지원에 대한 인식을 의미함</li>
<li>일상 생활에서 가깝게 지내는 사람들과의 관계에서 형성되므로, 사회적 지지는 행복 수준에 중요한 요소임을 알 수 있음</li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li>행복지수와 기부 문화 간 관계는?
<ul>
<li>상관계수는 2020년 0.069, 2021년 -0.018로, 상관관계가 거의 없는 것으로 나타남</li>
<li>따라서 기부 문화가 행복 수준과 직접적인 관련이 거의 없음을 확인할 수 있음</li>
</ul></li>
</ul>
<p><br></p>
<div id="11497463" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">## (2-3) 행복 점수와 전체 변수의 상관관계</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cf52e261" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 상관분석 : 2020년 데이터</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>corr <span class="op">=</span> df2020.select_dtypes(include<span class="op">=</span><span class="st">'number'</span>).corr()</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>upp_mat <span class="op">=</span> np.triu(corr)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>sns.heatmap(corr, mask<span class="op">=</span>upp_mat,vmin<span class="op">=-</span><span class="dv">1</span>, vmax<span class="op">=</span><span class="dv">1</span>, annot<span class="op">=</span><span class="va">True</span>, cmap <span class="op">=</span><span class="st">'RdYlBu_r'</span>, linewidths<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="3_2_regression_files/figure-html/cell-24-output-1.png" width="715" height="562" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="44c9c6a4" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 상관분석 : 2021년 데이터</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>corr <span class="op">=</span> df2021.select_dtypes(include<span class="op">=</span><span class="st">'number'</span>).corr()</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>upp_mat <span class="op">=</span> np.triu(corr)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>sns.heatmap(corr, mask<span class="op">=</span>upp_mat, vmin<span class="op">=-</span><span class="dv">1</span>, vmax<span class="op">=</span><span class="dv">1</span>,annot <span class="op">=</span> <span class="va">True</span>, cmap <span class="op">=</span><span class="st">'PiYG'</span>, linewidths<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="3_2_regression_files/figure-html/cell-25-output-1.png" width="715" height="562" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="결과-및-시사점-2" class="level5">
<h5 class="anchored" data-anchor-id="결과-및-시사점-2"><strong>결과 및 시사점</strong></h5>
<ul>
<li>2021년 행복지수에 가장 큰 영향을 미치는 요인은 경제적 여유(GDP, 0.79), 건강(0.77), 사회적 지지(0.76), 선택에 대한 자유도(0.61) 순으로 나타남</li>
<li>기부 활동과 행복지수는 뚜렷한 관련이 없는 것으로 나타남</li>
<li>1인당 GDP와 건강한 기대수명은 강한 양의 상관관계(0.86)가 있으므로, 경제적으로 여유로운 사람들이 더 건강하게 사는 경향이 있음을 알 수 있음</li>
</ul>
<p><br></p>
<p><br></p>
</section>
</section>
</section>
<section id="단순선형-회귀분석" class="level2">
<h2 class="anchored" data-anchor-id="단순선형-회귀분석">8.2. 단순선형 회귀분석</h2>
<ul>
<li>회귀(regression)
<ul>
<li>지도학습의 한 종류로, 정답(label)이 수치형 변수일 때 사용됨</li>
<li>하나 이상의 독립변수(x)가 종속변수(y)에 미치는 영향력의 크기를 수학적 관계식(모델)으로 추정하는 통계 기법
<ul>
<li>독립변수(independent variable) : 다른 변수의 변화를 야기하는 변수</li>
<li>종속변수(dependent variable) : 다른 변수의 영향으로 변화하는 변수</li>
</ul></li>
<li>학습된 모델은 새로운 독립변수 값에 대해 종속변수의 값을 예측할 수 있음</li>
<li>독립변수 개수에 따른 구분
<ul>
<li>단순선형 회귀(simple linear regression) : 독립변수가 1개인 경우</li>
<li>다중선형 회귀(multiple linear regression) : 독립변수가 2개 이상인 경우</li>
</ul></li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li>회귀모델 평가지표</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 35%">
<col style="width: 64%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">지표</th>
<th style="text-align: left;">설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">MSE <br>(Mean Squared Error)</td>
<td style="text-align: left;">- 평균제곱오차로, 작을수록 좋음</td>
</tr>
<tr class="even">
<td style="text-align: center;">RMSE <br>(Root Mean Squared Error)</td>
<td style="text-align: left;">- MSE의 양의 제곱근으로, 작을수록 좋음<br> - 단위가 데이터와 동일하여 해석이 용이함</td>
</tr>
<tr class="odd">
<td style="text-align: center;">MAE <br>(Mean Absolute Error)</td>
<td style="text-align: left;">- 평균절대오차로, 작을수록 좋음 <br>- 이상값에 덜 민감함</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(R^2\)</span> <br>(결정계수)</td>
<td style="text-align: left;">- 모델이 데이터의 변동을 얼마나 잘 설명하는지 나타내는 지표 <br>- 0~1 사이의 값을 가지며, 1에 가까울수록 모델의 설명력이 높음</td>
</tr>
</tbody>
</table>
<p><br></p>
<ul>
<li>단순선형 회귀분석
<ul>
<li>하나의 독립변수가 종속변수에 미치는 영향을 분석하는 통계 기법
<ul>
<li>예 : 공부 시간(독립변수)에 따른 시험 성적(종속변수)의 변화</li>
</ul></li>
<li>단순선형 회귀모델 <span class="math display">\[y = \beta_0 + \beta_1x + \epsilon\]</span>
<ul>
<li><span class="math inline">\(\beta_0\)</span> : 절편(intercept)</li>
<li><span class="math inline">\(\beta_1\)</span> : 기울기(slope)</li>
<li><span class="math inline">\(\epsilon\)</span> : 오차(error)</li>
</ul></li>
<li>회귀분석의 목적은 주어진 데이터를 가장 잘 설명하는 회귀선을 찾는 것
<ul>
<li>일반적으로 오차의 제곱합을 최소화하는 최소제곱추정법(OLS)을 사용함 <span class="math display">\[\hat{y} = b_0 + b_1x\]</span></li>
</ul></li>
<li>잔차(residual) : 관측값과 예측값의 차이, <span class="math inline">\(y-\hat{y}\)</span></li>
</ul></li>
</ul>
<p><br></p>
<p><img src="./images/fig3-8.jpg" class="img-fluid"></p>
<p><br></p>
<div id="cbca7d39" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 한글 깨짐 현상에 대한 해결 방법</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib <span class="im">as</span> mpl</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>plt.rc(<span class="st">'font'</span>, family<span class="op">=</span><span class="st">'Malgun Gothic'</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">'axes.unicode_minus'</span>] <span class="op">=</span> <span class="va">False</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="d5bc473b" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scikit-learn 설치하기</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co">#!pip install scikit-learn</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="8a4a71fd" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scikit-learn의 linear_model 모듈에서 LinearRegression 클래스 불러오기</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="df7b5a50" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">## 공부 시간(독립변수)에 따른 시험 성적(종속변수)의 변화</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터프레임 생성</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame({</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'study_time'</span>: [<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>],</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'score'</span>: [<span class="dv">81</span>, <span class="dv">93</span>, <span class="dv">90</span>, <span class="dv">97</span>, <span class="dv">100</span>]</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 산점도 : 두 변수 간 상관관계 확인</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">3</span>))</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>plt.scatter(data[<span class="st">'study_time'</span>], data[<span class="st">'score'</span>])</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Study Time (hours)'</span>)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Score'</span>)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 독립변수, 종속변수 분리</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="co"># scikit-Learn에서 입력 데이터(feature)를 2차원 배열로 요구함</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data[[<span class="st">'study_time'</span>]]</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data[<span class="st">'score'</span>]</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 선형 회귀모형 객체 생성 및 학습</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LinearRegression()</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>model.fit(X, y)</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a><span class="co"># 7시간 공부했을 때, 시험 점수 예측</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>newdata <span class="op">=</span> pd.DataFrame({<span class="st">'study_time'</span>: [<span class="dv">7</span>]})</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model.predict(newdata)</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'7시간 공부했을 때, 시험 점수 예측값 : </span><span class="sc">{</span>y_pred[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="3_2_regression_files/figure-html/cell-29-output-1.png" width="441" height="282" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>7시간 공부했을 때, 시험 점수 예측값 : 94.3</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="실습-날씨-데이터-분석" class="level2">
<h2 class="anchored" data-anchor-id="실습-날씨-데이터-분석">8.3. (실습) 날씨 데이터 분석</h2>
<ul>
<li>[데이터] 기상자료개방포털에서 제공하는 서울특별시의 기상 관측 데이터
<ul>
<li>2010년 1월 ~ 2020년 12월</li>
<li>날짜, 지점, 평균기온(℃), 최저기온(℃), 최고기온(℃)</li>
<li>[실습파일] <a href="./data/(2010-2020)_weather.csv">(2010-2020)_weather.csv</a></li>
</ul></li>
</ul>
<p><br></p>
<blockquote class="blockquote">
<p><strong>2021년 8월 15일의 평균기온을 예측하면?</strong></p>
</blockquote>
<p><br></p>
<div id="ddb7e782" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">## (1) 데이터 확인 및 전처리</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="3d1748d5" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 불러오기</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>seoul <span class="op">=</span> pd.read_csv(<span class="st">'./data/(2010-2020)_weather.csv'</span>, encoding<span class="op">=</span><span class="st">'cp949'</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>seoul.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">날짜</th>
<th data-quarto-table-cell-role="th">지점</th>
<th data-quarto-table-cell-role="th">평균기온(℃)</th>
<th data-quarto-table-cell-role="th">최저기온(℃)</th>
<th data-quarto-table-cell-role="th">최고기온(℃)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2010-01-01</td>
<td>108</td>
<td>-7.6</td>
<td>-12.7</td>
<td>-3.6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2010-01-02</td>
<td>108</td>
<td>-3.6</td>
<td>-7.4</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2010-01-03</td>
<td>108</td>
<td>-6.8</td>
<td>-10.5</td>
<td>-3.2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2010-01-04</td>
<td>108</td>
<td>-5.9</td>
<td>-8.0</td>
<td>-3.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2010-01-05</td>
<td>108</td>
<td>-9.9</td>
<td>-12.3</td>
<td>-7.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="8df55477" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 정보</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>seoul.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 4018 entries, 0 to 4017
Data columns (total 5 columns):
 #   Column   Non-Null Count  Dtype  
---  ------   --------------  -----  
 0   날짜       4018 non-null   object 
 1   지점       4018 non-null   int64  
 2   평균기온(℃)  4018 non-null   float64
 3   최저기온(℃)  4018 non-null   float64
 4   최고기온(℃)  4017 non-null   float64
dtypes: float64(3), int64(1), object(1)
memory usage: 157.1+ KB</code></pre>
</div>
</div>
<div id="98bafb83" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 전처리 : 열 삭제</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>seoul.drop(<span class="st">'지점'</span>, axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="ba7c5618" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 전처리 : 열 이름 변경</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>seoul.columns <span class="op">=</span> [<span class="st">'날짜'</span>, <span class="st">'평균기온'</span>, <span class="st">'최저기온'</span>, <span class="st">'최고기온'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="c070636b" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 전처리 : 결측값 확인</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>seoul.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>날짜      0
평균기온    0
최저기온    0
최고기온    1
dtype: int64</code></pre>
</div>
</div>
<div id="d1206d9b" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 전처리 : 결측값이 포함된 행 삭제</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>seoul.dropna(axis<span class="op">=</span><span class="dv">0</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="d064ceb2" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 전처리 : 날짜 변수를 datetime 형식으로 변환</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>seoul[<span class="st">'날짜'</span>] <span class="op">=</span> pd.to_datetime(seoul[<span class="st">'날짜'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="79c84562" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 전처리 : 새로운 변수(연도, 월, 일) 생성</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>seoul[<span class="st">'연도'</span>] <span class="op">=</span> seoul[<span class="st">'날짜'</span>].dt.year</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>seoul[<span class="st">'월'</span>]<span class="op">=</span>seoul[<span class="st">'날짜'</span>].dt.month</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>seoul[<span class="st">'일'</span>]<span class="op">=</span>seoul[<span class="st">'날짜'</span>].dt.day</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>seoul.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">날짜</th>
<th data-quarto-table-cell-role="th">평균기온</th>
<th data-quarto-table-cell-role="th">최저기온</th>
<th data-quarto-table-cell-role="th">최고기온</th>
<th data-quarto-table-cell-role="th">연도</th>
<th data-quarto-table-cell-role="th">월</th>
<th data-quarto-table-cell-role="th">일</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2010-01-01</td>
<td>-7.6</td>
<td>-12.7</td>
<td>-3.6</td>
<td>2010</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2010-01-02</td>
<td>-3.6</td>
<td>-7.4</td>
<td>0.2</td>
<td>2010</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2010-01-03</td>
<td>-6.8</td>
<td>-10.5</td>
<td>-3.2</td>
<td>2010</td>
<td>1</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2010-01-04</td>
<td>-5.9</td>
<td>-8.0</td>
<td>-3.4</td>
<td>2010</td>
<td>1</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2010-01-05</td>
<td>-9.9</td>
<td>-12.3</td>
<td>-7.0</td>
<td>2010</td>
<td>1</td>
<td>5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="dae2aece" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 전처리 : 8월 15일 데이터 선택</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>conditions <span class="op">=</span> (seoul[<span class="st">'월'</span>]<span class="op">==</span><span class="dv">8</span>) <span class="op">&amp;</span> (seoul[<span class="st">'일'</span>]<span class="op">==</span><span class="dv">15</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>seoul0815 <span class="op">=</span> seoul[conditions]</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>seoul0815</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">날짜</th>
<th data-quarto-table-cell-role="th">평균기온</th>
<th data-quarto-table-cell-role="th">최저기온</th>
<th data-quarto-table-cell-role="th">최고기온</th>
<th data-quarto-table-cell-role="th">연도</th>
<th data-quarto-table-cell-role="th">월</th>
<th data-quarto-table-cell-role="th">일</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">226</td>
<td>2010-08-15</td>
<td>26.6</td>
<td>24.6</td>
<td>30.2</td>
<td>2010</td>
<td>8</td>
<td>15</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">591</td>
<td>2011-08-15</td>
<td>24.5</td>
<td>22.9</td>
<td>26.9</td>
<td>2011</td>
<td>8</td>
<td>15</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">957</td>
<td>2012-08-15</td>
<td>23.7</td>
<td>22.4</td>
<td>27.1</td>
<td>2012</td>
<td>8</td>
<td>15</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1322</td>
<td>2013-08-15</td>
<td>28.7</td>
<td>25.8</td>
<td>32.4</td>
<td>2013</td>
<td>8</td>
<td>15</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1687</td>
<td>2014-08-15</td>
<td>24.9</td>
<td>20.9</td>
<td>29.6</td>
<td>2014</td>
<td>8</td>
<td>15</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2052</td>
<td>2015-08-15</td>
<td>27.1</td>
<td>23.1</td>
<td>30.8</td>
<td>2015</td>
<td>8</td>
<td>15</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2418</td>
<td>2016-08-15</td>
<td>29.1</td>
<td>25.8</td>
<td>34.0</td>
<td>2016</td>
<td>8</td>
<td>15</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2783</td>
<td>2017-08-15</td>
<td>21.9</td>
<td>20.8</td>
<td>24.0</td>
<td>2017</td>
<td>8</td>
<td>15</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3148</td>
<td>2018-08-15</td>
<td>31.7</td>
<td>28.3</td>
<td>38.0</td>
<td>2018</td>
<td>8</td>
<td>15</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3513</td>
<td>2019-08-15</td>
<td>25.9</td>
<td>23.9</td>
<td>28.6</td>
<td>2019</td>
<td>8</td>
<td>15</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3879</td>
<td>2020-08-15</td>
<td>26.1</td>
<td>25.0</td>
<td>27.0</td>
<td>2020</td>
<td>8</td>
<td>15</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><br></p>
<div id="7543bcd2" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">## (2) 데이터 분석 및 시각화</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="46f9fb3d" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 요약 통계량</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>seoul.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">날짜</th>
<th data-quarto-table-cell-role="th">평균기온</th>
<th data-quarto-table-cell-role="th">최저기온</th>
<th data-quarto-table-cell-role="th">최고기온</th>
<th data-quarto-table-cell-role="th">연도</th>
<th data-quarto-table-cell-role="th">월</th>
<th data-quarto-table-cell-role="th">일</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>4017</td>
<td>4017.000000</td>
<td>4017.000000</td>
<td>4017.000000</td>
<td>4017.000000</td>
<td>4017.000000</td>
<td>4017.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>2015-07-02 07:01:34.100074752</td>
<td>12.965596</td>
<td>8.991063</td>
<td>17.699627</td>
<td>2015.000249</td>
<td>6.521782</td>
<td>15.731392</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">min</td>
<td>2010-01-01 00:00:00</td>
<td>-14.800000</td>
<td>-18.000000</td>
<td>-10.700000</td>
<td>2010.000000</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25%</td>
<td>2012-10-01 00:00:00</td>
<td>3.700000</td>
<td>-0.300000</td>
<td>8.200000</td>
<td>2012.000000</td>
<td>4.000000</td>
<td>8.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">50%</td>
<td>2015-07-02 00:00:00</td>
<td>14.300000</td>
<td>9.800000</td>
<td>19.600000</td>
<td>2015.000000</td>
<td>7.000000</td>
<td>16.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">75%</td>
<td>2018-04-02 00:00:00</td>
<td>22.800000</td>
<td>18.900000</td>
<td>27.400000</td>
<td>2018.000000</td>
<td>10.000000</td>
<td>23.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">max</td>
<td>2020-12-31 00:00:00</td>
<td>33.700000</td>
<td>30.300000</td>
<td>39.600000</td>
<td>2020.000000</td>
<td>12.000000</td>
<td>31.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">std</td>
<td>NaN</td>
<td>10.805008</td>
<td>10.934039</td>
<td>10.976719</td>
<td>3.163104</td>
<td>3.449203</td>
<td>8.802435</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="e9b4ff8e" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 산점도 : 연도에 따른 평균기온 변화</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 독립변수, 종속변수 분리</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># scikit-learn에서 입력 데이터(feature)를 2차원 배열로 요구함</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> seoul0815[[<span class="st">'연도'</span>]]</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> seoul0815[<span class="st">'평균기온'</span>]</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">3</span>))</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>plt.scatter(X, y)</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'연도'</span>)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'평균기온'</span>)</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="3_2_regression_files/figure-html/cell-42-output-1.png" width="434" height="283" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="ec458ac0" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 상관계수 : 연도와 평균기온의 상관관계</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 연도와 평균기온은 약한 양의 상관관계로 나타나, 단순선형 회귀모형을 적합할 수 있음</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>seoul0815[[<span class="st">'연도'</span>, <span class="st">'평균기온'</span>]].corr()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">연도</th>
<th data-quarto-table-cell-role="th">평균기온</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">연도</td>
<td>1.000000</td>
<td>0.194953</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">평균기온</td>
<td>0.194953</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="56320bb3" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 단순선형 회귀분석 : 2021년 8월 15일 평균기온 예측</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 선형 회귀모델 생성 및 학습</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LinearRegression()</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>model.fit(X, y)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 회귀식의 절편 및 기울기</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>intercept <span class="op">=</span> model.intercept_</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>slope <span class="op">=</span> model.coef_</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'회귀식: hat(y) = </span><span class="sc">{</span>model<span class="sc">.</span>intercept_<span class="sc">:.2f}</span><span class="ss"> + </span><span class="sc">{</span>model<span class="sc">.</span>coef_[<span class="dv">0</span>]<span class="sc">:.2f}</span><span class="ss">*x'</span>)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 결정계수</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>R2 <span class="op">=</span> model.score(X, y)</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'결정계수 : </span><span class="sc">{</span>R2<span class="sc">:.3f}</span><span class="ss">'</span>)</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 2021년일 때, 평균기온 예측</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>newdata <span class="op">=</span> pd.DataFrame({<span class="st">'연도'</span>: [<span class="dv">2022</span>]})</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model.predict(newdata)</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'2021년 8월 15일 평균기온 예측값 : </span><span class="sc">{</span>y_pred[<span class="dv">0</span>]<span class="sc">:.2f}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>회귀식: hat(y) = -297.85 + 0.16*x
결정계수 : 0.038
2021년 8월 15일 평균기온 예측값 : 27.51</code></pre>
</div>
</div>
<div id="1ed16111" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 산점도와 단순선형 회귀선</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">3</span>))   </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>sns.regplot(x<span class="op">=</span><span class="st">'연도'</span>, y<span class="op">=</span><span class="st">'평균기온'</span>, data<span class="op">=</span>seoul0815)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="3_2_regression_files/figure-html/cell-45-output-1.png" width="434" height="283" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
<section id="결과-및-시사점-3" class="level5">
<h5 class="anchored" data-anchor-id="결과-및-시사점-3"><strong>결과 및 시사점</strong></h5>
<ul>
<li>연도와 평균기온은 약한 양의 상관관계(r=0.195)로 나타나, 단순선형 회귀모형을 적합할 수 있음</li>
<li>독립변수는 연도, 종속변수는 평균기온으로 단순선형 회귀분석을 실시한 결과, 모형의 설명력은 3.8%로 비교적 낮게 나타남</li>
<li>적합된 회귀식 : <span class="math inline">\(\hat{y} = -297.85 + 0.16*x\)</span>
<ul>
<li>연도가 1년 증가할수록 8월 15일의 평균기온은 약 0.16℃ 상승하는 것으로 추정됨</li>
</ul></li>
<li>따라서 2021년 8월 15일의 평균기온은 27.51℃로 예측됨</li>
</ul>
<p><br></p>
<p><br></p>
</section>
</section>
<section id="다중선형-회귀분석" class="level2">
<h2 class="anchored" data-anchor-id="다중선형-회귀분석">8.4. 다중선형 회귀분석</h2>
<ul>
<li>다중선형 회귀분석
<ul>
<li>두 개 이상의 독립변수가 종속변수에 미치는 영향을 분석하는 통계 기법
<ul>
<li>예: 공부 시간, 수면 시간, 강의 출석률(독립변수들)에 따른 시험 성적(종속변수)의 변화</li>
</ul></li>
<li>다중선형 회귀모델 <span class="math display">\[y = \beta_0 + \beta_1x_1 + \beta_2x_2 + \cdots + \beta_p x_p + \epsilon\]</span>
<ul>
<li><span class="math inline">\(\beta_0\)</span> : 절편(intercept)<br>
</li>
<li><span class="math inline">\(\beta_1, \beta_2, \dots, \beta_p\)</span> : 각 독립변수의 기울기(slope)</li>
<li><span class="math inline">\(\epsilon\)</span> : 오차(error)</li>
</ul></li>
</ul></li>
</ul>
<p><br></p>
</section>
<section id="실습-캘리포니아-주택-가격-분석" class="level2">
<h2 class="anchored" data-anchor-id="실습-캘리포니아-주택-가격-분석">8.5. (실습) 캘리포니아 주택 가격 분석</h2>
<ul>
<li>[데이터] scikit-learn에서 제공하는 캘리포니아 주택 가격 데이터
<ul>
<li>1990년대 캘리포니아 지역의 주택 가격에 대한 데이터</li>
<li>총 20,640개의 관측값과 8개의 독립변수(feature), 1개의 종속변수(target)으로 구성됨</li>
<li><code>as_frame=True</code> 옵션을 사용하면 독립변수와 종속변수를 DataFrame 형태로 불러올 수 있음</li>
<li><code>as_frame=False</code> 옵션(기본값)을 사용하면 독립변수와 종속변수를 각각 넘파이 배열 형태로 별도로 제공함</li>
</ul></li>
</ul>
<p><br></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">변수</th>
<th style="text-align: left;">설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">MedInc</td>
<td style="text-align: left;">지역 중위 소득 (10,000 USD)</td>
</tr>
<tr class="even">
<td style="text-align: left;">HouseAge</td>
<td style="text-align: left;">주택 연식 (건축 후 경과된 연도 수)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AveRooms</td>
<td style="text-align: left;">가구당 평균 방 개수</td>
</tr>
<tr class="even">
<td style="text-align: left;">AveBedrms</td>
<td style="text-align: left;">가구당 평균 침실 개수</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Population</td>
<td style="text-align: left;">지역 내 인구 수</td>
</tr>
<tr class="even">
<td style="text-align: left;">AveOccup</td>
<td style="text-align: left;">가구당 평균 거주 인원 수</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Latitude</td>
<td style="text-align: left;">위도</td>
</tr>
<tr class="even">
<td style="text-align: left;">Longitude</td>
<td style="text-align: left;">경도</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MedHouseVal</td>
<td style="text-align: left;">주택 중위 가격 (100,000 USD)</td>
</tr>
</tbody>
</table>
<p><br></p>
<div id="9b5ec184" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">## (1) 데이터 확인 및 전처리</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="29c0a869" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 불러오기</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> fetch_california_housing</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> fetch_california_housing(as_frame<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> data.frame</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MedInc</th>
<th data-quarto-table-cell-role="th">HouseAge</th>
<th data-quarto-table-cell-role="th">AveRooms</th>
<th data-quarto-table-cell-role="th">AveBedrms</th>
<th data-quarto-table-cell-role="th">Population</th>
<th data-quarto-table-cell-role="th">AveOccup</th>
<th data-quarto-table-cell-role="th">Latitude</th>
<th data-quarto-table-cell-role="th">Longitude</th>
<th data-quarto-table-cell-role="th">MedHouseVal</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>8.3252</td>
<td>41.0</td>
<td>6.984127</td>
<td>1.023810</td>
<td>322.0</td>
<td>2.555556</td>
<td>37.88</td>
<td>-122.23</td>
<td>4.526</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>8.3014</td>
<td>21.0</td>
<td>6.238137</td>
<td>0.971880</td>
<td>2401.0</td>
<td>2.109842</td>
<td>37.86</td>
<td>-122.22</td>
<td>3.585</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>7.2574</td>
<td>52.0</td>
<td>8.288136</td>
<td>1.073446</td>
<td>496.0</td>
<td>2.802260</td>
<td>37.85</td>
<td>-122.24</td>
<td>3.521</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>5.6431</td>
<td>52.0</td>
<td>5.817352</td>
<td>1.073059</td>
<td>558.0</td>
<td>2.547945</td>
<td>37.85</td>
<td>-122.25</td>
<td>3.413</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>3.8462</td>
<td>52.0</td>
<td>6.281853</td>
<td>1.081081</td>
<td>565.0</td>
<td>2.181467</td>
<td>37.85</td>
<td>-122.25</td>
<td>3.422</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="c3803839" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 정보</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>df.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 20640 entries, 0 to 20639
Data columns (total 9 columns):
 #   Column       Non-Null Count  Dtype  
---  ------       --------------  -----  
 0   MedInc       20640 non-null  float64
 1   HouseAge     20640 non-null  float64
 2   AveRooms     20640 non-null  float64
 3   AveBedrms    20640 non-null  float64
 4   Population   20640 non-null  float64
 5   AveOccup     20640 non-null  float64
 6   Latitude     20640 non-null  float64
 7   Longitude    20640 non-null  float64
 8   MedHouseVal  20640 non-null  float64
dtypes: float64(9)
memory usage: 1.4 MB</code></pre>
</div>
</div>
<div id="eadfb2ed" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 전처리 : 결측값 확인</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>df.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>MedInc         0
HouseAge       0
AveRooms       0
AveBedrms      0
Population     0
AveOccup       0
Latitude       0
Longitude      0
MedHouseVal    0
dtype: int64</code></pre>
</div>
</div>
<p><br></p>
<div id="e24ce335" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">## (2) 학습/평가 데이터 분할</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="72973c0a" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 전처리 : 학습/평가 데이터 분할 (7:3 비율)</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data.data</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data.target</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<div id="458b0f43" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">## (3) 데이터 탐색</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="bc28898a" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 요약 통계량 확인</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>df_train <span class="op">=</span> pd.concat([X_train, y_train], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>df_train.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MedInc</th>
<th data-quarto-table-cell-role="th">HouseAge</th>
<th data-quarto-table-cell-role="th">AveRooms</th>
<th data-quarto-table-cell-role="th">AveBedrms</th>
<th data-quarto-table-cell-role="th">Population</th>
<th data-quarto-table-cell-role="th">AveOccup</th>
<th data-quarto-table-cell-role="th">Latitude</th>
<th data-quarto-table-cell-role="th">Longitude</th>
<th data-quarto-table-cell-role="th">MedHouseVal</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>14448.000000</td>
<td>14448.000000</td>
<td>14448.000000</td>
<td>14448.000000</td>
<td>14448.000000</td>
<td>14448.000000</td>
<td>14448.000000</td>
<td>14448.000000</td>
<td>14448.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>3.876892</td>
<td>28.575374</td>
<td>5.438125</td>
<td>1.098033</td>
<td>1427.927326</td>
<td>3.119236</td>
<td>35.650669</td>
<td>-119.584102</td>
<td>2.069240</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>1.904908</td>
<td>12.613634</td>
<td>2.453569</td>
<td>0.447498</td>
<td>1140.225190</td>
<td>12.373636</td>
<td>2.135742</td>
<td>2.002930</td>
<td>1.157492</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>0.499900</td>
<td>1.000000</td>
<td>0.888889</td>
<td>0.333333</td>
<td>3.000000</td>
<td>0.692308</td>
<td>32.550000</td>
<td>-124.350000</td>
<td>0.149990</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>2.567225</td>
<td>18.000000</td>
<td>4.448928</td>
<td>1.006783</td>
<td>791.000000</td>
<td>2.430380</td>
<td>33.940000</td>
<td>-121.800000</td>
<td>1.193000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>3.539100</td>
<td>29.000000</td>
<td>5.232422</td>
<td>1.049492</td>
<td>1168.000000</td>
<td>2.817147</td>
<td>34.270000</td>
<td>-118.510000</td>
<td>1.793000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>4.758075</td>
<td>37.000000</td>
<td>6.060692</td>
<td>1.100328</td>
<td>1727.000000</td>
<td>3.279135</td>
<td>37.720000</td>
<td>-118.010000</td>
<td>2.646000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>15.000100</td>
<td>52.000000</td>
<td>141.909091</td>
<td>25.636364</td>
<td>35682.000000</td>
<td>1243.333333</td>
<td>41.950000</td>
<td>-114.310000</td>
<td>5.000010</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="eb5cbed7" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 중위 주택 가격에 대한 분포</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">3</span>))</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>sns.histplot(df_train[<span class="st">'MedHouseVal'</span>], color<span class="op">=</span><span class="st">'forestgreen'</span>)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="3_2_regression_files/figure-html/cell-54-output-1.png" width="441" height="282" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="7770b487" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 중위 주택 가격에 대한 분포</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">2</span>))</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'MedHouseVal'</span>, color<span class="op">=</span><span class="st">'tomato'</span>, data<span class="op">=</span>df_train)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="3_2_regression_files/figure-html/cell-55-output-1.png" width="396" height="208" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="93472334" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 산점도</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>sns.pairplot(df_train, height<span class="op">=</span><span class="fl">0.8</span>, plot_kws<span class="op">=</span>{<span class="st">'s'</span>: <span class="dv">5</span>}, diag_kind<span class="op">=</span><span class="st">'kde'</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="3_2_regression_files/figure-html/cell-56-output-1.png" width="683" height="683" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="b7cf1e13" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 상관분석</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>corr_train <span class="op">=</span> df_train.corr()</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>upp_mat <span class="op">=</span> np.triu(corr_train)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>sns.heatmap(corr_train, annot<span class="op">=</span><span class="va">True</span>, mask<span class="op">=</span>upp_mat, cmap<span class="op">=</span><span class="st">'BrBG'</span>, vmin<span class="op">=-</span><span class="dv">1</span>, vmax<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Correlation Matrix'</span>)</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="3_2_regression_files/figure-html/cell-57-output-1.png" width="680" height="575" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
<div id="a1605a36" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">## (4) 회귀모델 학습</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="180a0f00" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 상관관계가 강한 독립변수 선택</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co"># scikit-learn에서 입력 데이터(feature)를 2차원 배열로 요구함</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> [<span class="st">'MedInc'</span>, <span class="st">'HouseAge'</span>, <span class="st">'AveRooms'</span>, <span class="st">'Latitude'</span>]</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> df_train[features]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="0b161925" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 선형 회귀모델 생성 및 학습</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LinearRegression()</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>model.fit(X_train, y_train)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 회귀계수(regression coefficient)</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>pd.DataFrame({<span class="st">'Featurs'</span>: features, <span class="st">'Coefficient'</span>: model.coef_})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Featurs</th>
<th data-quarto-table-cell-role="th">Coefficient</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>MedInc</td>
<td>0.435658</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>HouseAge</td>
<td>0.016937</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>AveRooms</td>
<td>-0.019505</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Latitude</td>
<td>-0.045071</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="5d2c11bb" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># statsmodels 라이브러리 설치</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="co">#!pip install statsmodels</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="4179263b" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># [참고] 회귀계수의 유의성</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>X_train_const <span class="op">=</span> sm.add_constant(X_train)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>ols_model <span class="op">=</span> sm.OLS(y_train, X_train_const).fit()</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ols_model.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            OLS Regression Results                            
==============================================================================
Dep. Variable:            MedHouseVal   R-squared:                       0.519
Model:                            OLS   Adj. R-squared:                  0.518
Method:                 Least Squares   F-statistic:                     3890.
Date:                Thu, 24 Jul 2025   Prob (F-statistic):               0.00
Time:                        23:05:46   Log-Likelihood:                -17332.
No. Observations:               14448   AIC:                         3.467e+04
Df Residuals:                   14443   BIC:                         3.471e+04
Df Model:                           4                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
const          1.6091      0.115     13.957      0.000       1.383       1.835
MedInc         0.4357      0.004    116.405      0.000       0.428       0.443
HouseAge       0.0169      0.001     31.487      0.000       0.016       0.018
AveRooms      -0.0195      0.003     -6.652      0.000      -0.025      -0.014
Latitude      -0.0451      0.003    -14.213      0.000      -0.051      -0.039
==============================================================================
Omnibus:                     3079.717   Durbin-Watson:                   1.979
Prob(Omnibus):                  0.000   Jarque-Bera (JB):             8182.373
Skew:                           1.148   Prob(JB):                         0.00
Kurtosis:                       5.884   Cond. No.                         809.
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</code></pre>
</div>
</div>
<p><br></p>
<section id="결과-및-시사점-4" class="level5">
<h5 class="anchored" data-anchor-id="결과-및-시사점-4"><strong>결과 및 시사점</strong></h5>
<ul>
<li>독립변수가 중위 주택 가격에 미치는 영향은 다음과 같음
<ul>
<li>지역 중위 소득이 1만 달러 증가할 때, 중위 주택 가격은 약 4만 3천 달러 증가하는 것으로 나타남. 이는 경제적으로 여유로운 가구일수록 더 비싼 주택에 거주하는 경향이 있음</li>
<li>주택 연식이 1년 증가하면, 중위 주택 가격은 약 1,693달러 상승하는 것으로 나타남</li>
<li>가구당 평균 방 개수가 1개 늘어날수록, 중위 주택 가격은 약 1,950달러 감소하는 경향이 있음</li>
<li>위도가 1도 증가하면, 중위 주택 가격은 약 4,507달러 하락함. 이는 일반적으로 갤리포니아주 남부 지역에 대도시가 집중되어 있어, 해당 지역의 주택 가격이 반영된 것으로 해석됨</li>
</ul></li>
</ul>
<p><br></p>
<div id="95ce767e" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co">## (5) 회귀모델 평가</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="413ec340" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 평가 데이터에서도 학습 데이터에서 사용한 독립변수만 선택</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> X_test[features]</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 평가 데이터의 예측값</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model.predict(X_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="9991c19c" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 회귀모델 평가 : RMSE, 결정계수</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error, r2_score</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>RMSE <span class="op">=</span> np.sqrt(mean_squared_error(y_test, y_pred))</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>R2 <span class="op">=</span> r2_score(y_test, y_pred)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'RMSE : </span><span class="sc">{</span>RMSE<span class="sc">:.3f}</span><span class="ss">'</span>)</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'결정계수 : </span><span class="sc">{</span>R2<span class="sc">:.3f}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>RMSE : 0.794
결정계수 : 0.520</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="결과-및-시사점-5" class="level5">
<h5 class="anchored" data-anchor-id="결과-및-시사점-5"><strong>결과 및 시사점</strong></h5>
<ul>
<li>결정계수 <span class="math inline">\(R^2\)</span>은 52.0%로 나타남</li>
<li>RMSE는 0.794로, 주택 중위 가격의 실제값과 예측값이 평균적으로 약 8만 달러 차이가 있다는 것을 의미함</li>
<li>학습 데이터에서 주택 중위 가격의 평균은 약 20만 달러인 점을 고려하면, 모델의 평균 오차는 약 25% 수준임을 알 수 있음</li>
<li>따라서 평균 오차가 비교적 큰 편이므로, 모델 성능 개선이 필요한 것으로 판단됨</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>